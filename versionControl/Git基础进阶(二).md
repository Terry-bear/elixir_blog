---
title: "Git基础进阶(二)"
date: 2019-04-21T17:02:01+08:00
lastmod: 2019-04-21T17:02:01+08:00
draft: false
keywords: ["personal"]
description: ""
tags: ["personal"]
categories: ["personal"]
author: "Terryzh"

postMetaInFooter: false

---

<!--more-->

了解了基础的Git的用法，相信大家在掌握基本命令后已经可以熟练使用了。对于个人开发，我们或许不需要太多的协作或者code review，一个人对代码的维护更大的体现是对历史提交的查看和变更，这个在基础章节已经有详细的应用了。

那么，我们都知道，代码的开发，很多情况下是多人协作的一个状态，在多人协作的情况下，我们该如何确保对代码的维护达到一个共同的认可和持续的迭代呢？

这时候，我们就不得不请出我们Git的另一大黑科技般的功能了。

**代码分支**

**代码标签**

接下来，将一一介绍他们的详细使用。

## 为什么有分支（branch）

首先，我们应该明确一点，什么是**分支**，可以看到，字面意思的分支，应该是从主干道上面做一个分流的操作，就像长江黄河汇入大海的图中，会遇到很多的分流，包括一系列的小河小溪。

Git中分支的出现大大扩展了Git作为版本控制的大佬地位。

> 我们在每创建一个新的分支的时候，其实都是对当前hard指针所在位置的分支进行克隆，然后将历史的commit打入新分支内。这一点需要特别注意，新建分支是不会出现空分支（没有commit）的情况。

废话不多少，分支在Git中，确认也是相同的意思。
那我们就首先创建一个自己的分支吧。

```bash
# 创建自定义名字的分支
git branch [new branch name]
# 切换到自定义的分支下
git checkout [new branch name]
```

### 分解下这两个命令

`git branch`做了什么？

![git branch](/img/picture/git2-newbranch.png)

可以看出在`git branch`创建新分支时，是基于当前hard的分支（master）的克隆。
也就是说，hard是我们当前的指针，这个指针指向了master并且基于master创建了新的dev。
此时，我么的hard还在master上。

我们需要`git checkout`把hard的指针指向我们新创建的分支dev下。

![git branch](/img/picture/git2-checkout.png)

我们也可以用一条命令代替上述的两个命令，达到同样的效果。

```bash
git checkout -b [new branch name]
```

这时候我们可以用`git branch`看到，我们的版本库里面已经多了一个分支了。

```bash
$ git branch
master
*dev
```

此时我们看到的分支是本地分支，那如何把本地已经修改好的分支提交到线上呢？

```bash
# 和提交commit一样丝滑柔顺
git push orgin [branch name]
```

这样，我们对于分支，就有了一个初步的概念和理解了。关于分支深入的内容会在后面的章节提及。这里只针对初学者和基本常用的操作，不涉及复杂操作，划清难度和功能的边界，我觉得更有助于读者的目的性。

## 为什么有标签（tag）

接下来让我们谈一谈tag的意义，网上关于Git的使用教程千千万，这里我不会按照死板的方式进行简单的诉说，而是根据结合了个人在实战工作中运用Git来进行操作的频率对文章进行大小的分级的。所以总体上来看会有些许的凌乱，但是带来的实际价值却是值得肯定的。

在工作中，对于入门1-3年的前端小白，或者是后端小白往往用不到tag这个东西，即使用到了，也是自己部门的技术经理或者架构师告诉你，“嗯，你把XX功能加上了以后打一个tag，这边我好做处理”。

那么，其实tag对我们来说更想是一个附加的隐性功能，在初级的工作中只要会打tag就行了。完全不用考虑为什么要打tag。

博主在这里就稍微的分析了一下。

**我们为什么要打tag**

经常混迹github或者是gitlab的人应该知道，在github上有很多的开源代码，这些代码的维护往往涉及到了复杂的团队协作和交互。

对于tag的管理，更多的应用应该是release版本上。release版本中会剔除掉很多的日常commit，这些日常commit是不会出现在release版本中的。我们的每一个commit提交，就是一个tag。

tag的使用也有蛮多，但是目前博主了解到，tag的使用相对较为自由，没有相应的标准化。

最常使用的是将tag的版本分为三个迭代。

**0.0.0**

第一个0是代码的大版本更新，主要会涉及到重大的bug修复，或者是大篇幅的代码重构，也可能是新加入的功能和往期版本的功能有大幅的变动。

第二个0是代码的二级更新，主要会涉及到一些小功能的添加，一些紧急的bug修复，或者是小篇幅的代码重构和优化工作。

第三个0是代码的三级更新，主要会涉及到日常的小bug修复，并且这种篇幅的更新一定不会涉及到代码命名的更改和交互方式的变动。

---

说了这么多，其实还是想让小萌新们对tag有一个基础的认识了了解。

其实在Git中，tag的用法非常的简单。但是想用好tag，还是需要工作经验的沉淀。

### 列出标签

列出现有标签的命令非常简单，直接运行 `git tag` 即可：

```bash
$ git tag
v0.1
v1.3
```

git tag 也支持模糊查询

```bash
$ git tag -l 'v1.4.2.*'
v1.4.2.1
v1.4.2.2
v1.4.2.3
v1.4.2.4
```

### 新建标签

Git 使用的标签有两种类型：
**轻量级的（lightweight）**和**含附注的（annotated）**。

- 轻量级标签就像是个不会变化的分支，实际上它就是个指向特定提交对象的引用。
- 含附注标签，实际上是存储在仓库中的一个独立对象，它有自身的校验和信息，包含着标签的名字，电子邮件地址和日期，以及标签说明。

> ps: 附注标签本身也允许使用 GNU Privacy Guard (GPG) 来签署或验证。

#### 新建含附注的标签

创建一个含附注类型的标签非常简单.

- `-a` （译注：取 annotated 的首字母）指定标签名字即可。
- `-m` 选项则指定了对应的标签说明

```bash
$ git tag -a v1.4 -m 'my version 1.4'
$ git tag
v0.1
v1.3
v1.4
```

可以使用 git show 命令查看相应标签的版本信息

```bash
$ git show v1.4
# tag 名字
tag v1.4
# 基础信息
Tagger: Scott Chacon <schacon@gee-mail.com>
# 创建日期
Date:   Mon Feb 9 14:45:11 2009 -0800
# -m自己添加的信息
my version 1.4
# commit版本号
commit 15027957951b64cf874c3557a0f3547bd83b3ff6
# 是否融合过分支
Merge: 4a447f7... a6b4c97...
# 基础信息
Author: Scott Chacon <schacon@gee-mail.com>
# 时间
Date:   Sun Feb 8 19:02:46 2009 -0800
    Merge branch 'experiment'
```

## 此章命令的小结

这一节总结了上述小节出现的各种命令并且做了相应的小幅度扩展。

| 作用 | 命令 | 常用参数 |
| --- | --- | --- |
| 查看分支 | git branch | -r 可查看远程 |
| 新建分支并检出 | git checkout -b [newBranch] | -b 新建分支 |
| 查看标签 | git tag -l 'XXX' | -l 模糊查询 |
| 删除分支 | git branch -d [branch name] | -d 删除 |
| 合并分支 | git merge [branch name] | - |

> ps: 合并分支会涉及到很多问题，今天就先讲到这里，下期见啦。🤣🤣🤣
